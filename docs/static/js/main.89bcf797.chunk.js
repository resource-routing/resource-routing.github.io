(this["webpackJsonpresouce-routing"]=this["webpackJsonpresouce-routing"]||[]).push([[0],{15:function(t,e,n){},16:function(t,e,n){},18:function(t,e,n){"use strict";n.r(e);var a=n(1),s=n.n(a),i=n(8),c=n.n(i),r=(n(15),n(2)),o=n(3),l=n(4),d=n(6),h=n(5),u=(n(16),n(9)),b=n(0);function p(t){var e=t.layout,n=t.children,a=t.borderClass;return Object(b.jsx)("div",{className:Object(u.a)("component",a),style:{position:"absolute",top:e.y,left:e.x,width:e.w,height:e.h},children:n})}function j(t){var e=t.expanded,n=t.setExpanded;return Object(b.jsx)("button",{className:"icon-button",onClick:function(){return n(!e)},children:e?"-":"+"})}function m(t){var e=t.name,n=t.branchIndex,a=t.index,s=t.expanded,i=t.isLast,c=t.isLastBranch,r=t.isFirstBranch,o=t.editing,l=t.actions;return Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{className:"icon-button-width",children:o&&Object(b.jsx)("button",{className:"icon-button",title:"Break branch",disabled:!0,children:"/"})}),Object(b.jsx)("td",{className:"icon-button-width",children:Object(b.jsx)(j,{expanded:s,setExpanded:function(t){return l.setSplitExpandedAt(n,a,t)}})}),Object(b.jsx)("td",{colSpan:"2",children:o?Object(b.jsx)("input",{className:"full-width",placeholder:"Split Name",type:"text",value:e,onChange:function(t){return l.setSplitNameAt(n,a,t.target.value)}}):Object(b.jsx)("u",{children:e})}),o&&Object(b.jsx)("td",{className:"icon-button-width",children:Object(b.jsx)("button",{className:"icon-button",title:"Copy",disabled:!0,children:"c"})}),o&&Object(b.jsx)("td",{className:"icon-button-width",children:Object(b.jsx)("button",{className:"icon-button",disabled:0===a&&r,title:"Move up",children:"\u2191"})}),o&&Object(b.jsx)("td",{className:"icon-button-width",children:Object(b.jsx)("button",{className:"icon-button",title:"Move down",disabled:i&&c,children:"\u2193"})}),o&&Object(b.jsx)("td",{className:"icon-button-width",children:Object(b.jsx)("button",{className:"icon-button",title:"Delete",onClick:function(){l.displayAlert("Delete split ".concat(e,"? This will also delete all actions in the split. (Not reversible)"),"Delete",(function(){l.hideAlert(),l.deleteSplitAt(n,a)}),"Cancel",(function(){l.hideAlert()}))},children:"X"})}),o&&Object(b.jsx)("td",{className:"icon-button-width",children:Object(b.jsx)("button",{className:"icon-button",title:"New Split Below",onClick:function(){return l.createSplitAt(n,a+1)},children:"*"})}),o&&Object(b.jsx)("td",{className:"icon-button-width",children:Object(b.jsx)("button",{className:"icon-button",title:"Paste Split Below",disabled:!0,onClick:function(){return l.createSplitAt(n,a+1)},children:"p"})})]})}function v(t){var e=t.branchIndex,n=t.splits,a=t.isLastBranch,s=t.isFirstBranch,i=t.editing,c=t.actions,r=n.map((function(t,r){return Object(b.jsx)(m,{name:t.name,branchIndex:e,index:r,expanded:t.expanded,isLast:r==n.length-1,isLastBranch:a,isFirstBranch:s,editing:i,actions:c},"".concat(e,"-").concat(r))}));return r.push(Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{className:"icon-button-width",children:i&&Object(b.jsx)("button",{className:"icon-button",disabled:!0,title:"Merge branch",children:"^"})}),Object(b.jsxs)("td",{colSpan:"4",children:[Object(b.jsx)("button",{onClick:function(){return c.createSplitAt(e,n.length)},children:"New Split"}),Object(b.jsx)("button",{className:"space-left-small",disabled:!0,children:"Paste Split"})]})]})),r}function f(t){var e=t.name,n=t.index,a=t.expanded,s=t.editing,i=t.actions,c=t.isLast,r=t.splits,o=Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{className:"icon-button-width",children:Object(b.jsx)(j,{expanded:a,setExpanded:function(t){return i.setBranchExpandedAt(n,t)}})}),Object(b.jsx)("td",{colSpan:"6",children:s?Object(b.jsx)("input",{className:"full-width",placeholder:"Branch Name",type:"text",value:e,onChange:function(t){return i.setBranchNameAt(n,t.target.value)}}):Object(b.jsx)("strong",{children:e})}),s&&Object(b.jsx)("td",{className:"icon-button-width",children:Object(b.jsx)("button",{className:"icon-button",disabled:0===n,title:"Move up",onClick:function(){return i.swapBranchesAt(n,n-1)},children:"\u2191"})}),s&&Object(b.jsx)("td",{className:"icon-button-width",children:Object(b.jsx)("button",{className:"icon-button",title:"Move down",disabled:c,onClick:function(){return i.swapBranchesAt(n,n+1)},children:"\u2193"})}),s&&Object(b.jsx)("td",{className:"icon-button-width",children:Object(b.jsx)("button",{className:"icon-button",title:"Delete",onClick:function(){i.displayAlert("Delete branch ".concat(e,"? This will also delete all the splits in the branch. (Not reversible)"),"Delete",(function(){i.hideAlert(),i.deleteBranchAt(n)}),"Cancel",(function(){i.hideAlert()}))},children:"X"})}),s&&Object(b.jsx)("td",{className:"icon-button-width",children:Object(b.jsx)("button",{className:"icon-button",title:"New Branch Below",onClick:function(){return i.createBranchAt(n+1)},children:"*"})})]});return a?[o].concat(Object(b.jsx)(v,{branchIndex:n,splits:r,isLastBranch:c,isFirstBranch:0===n,editing:s,actions:i})):o}function x(t){var e=t.branches,n=t.editing,a=t.actions;return e?Object(b.jsx)("table",{children:Object(b.jsxs)("tbody",{children:[e.map((function(t,s){return Object(b.jsx)(f,{name:t.name,index:s,expanded:t.expanded,editing:n,actions:a,isLast:s===e.length-1,splits:t.splits},s)})),Object(b.jsx)("tr",{children:Object(b.jsx)("td",{colSpan:"3",children:Object(b.jsx)("button",{onClick:function(){return a.createBranchAt(e.length)},children:"New Branch"})})})]})}):null}var S=function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(t){var a;return Object(o.a)(this,n),(a=e.call(this,t)).state={editing:!1},a}return Object(l.a)(n,[{key:"setEditEnabled",value:function(t){this.setState({editing:t})}},{key:"render",value:function(){var t=this,e=Object(b.jsxs)("span",{children:[Object(b.jsx)("button",{className:"space-left-small",onClick:function(){return t.setEditEnabled(!t.state.editing)},children:this.state.editing?"Finish":"Edit"}),Object(b.jsx)("button",{className:"space-left-small",disabled:!0,children:"Collapse"}),Object(b.jsx)("button",{className:"space-left-small",disabled:!0,children:"Expand"})]}),n=Object(b.jsx)(x,{branches:this.props.branches,editing:this.state.editing,actions:this.props.actions});return Object(b.jsxs)("div",{children:[Object(b.jsxs)(p,{layout:this.props.layout.header,children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("button",{onClick:function(){return t.props.actions.setSideCollapsed(!t.props.sideCollapsed)},children:this.props.sideCollapsed?">>":"<<"}),!this.props.sideCollapsed&&e]}),Object(b.jsx)("hr",{})]}),Object(b.jsx)(p,{layout:this.props.layout.main,borderClass:"overflow-auto",children:Object(b.jsx)("div",{children:!this.props.sideCollapsed&&n})})]})}}]),n}(s.a.Component),O=n(10);function y(){return(new Date).getTime()}function C(t){return(new Date).getTime()-t}var w="RRT_STATE_v1";function A(){var t=localStorage.getItem(w);return t?N(JSON.parse(t)):N()}function N(t){if(!t)return{projectName:"Untitled Project",activeSplit:-1,activeBranch:-1,branches:[]};var e,n=g(t.activeBranch,t.branches);return e=-1===n?-1:g(t.activeSplit,t.branches[t.activeBranch].splits),{projectName:t.projectName||"Untitled Project",activeBranch:n,activeSplit:e,branches:t.branches.map(B)}}function g(t,e){return e&&e.length?t<0||t>e.length?-1:t:-1}function B(t){var e={name:"",expanded:!1,splits:[]};if(!t)return Object(r.a)({},e);var n=Object(r.a)({},e);return t.name&&(n.name=t.name),t.expanded&&(n.expanded=!0),t.splits&&(n.splits=t.splits.map(k)),n}function k(t){var e={name:"",expanded:!1,actions:[]};if(!t)return Object(r.a)({},e);var n=Object(r.a)({},e);return t.name&&(n.name=t.name),t.expanded&&(n.expanded=!0),t.actions&&(n.actions=t.actions.map(T)),n}function T(t){var e={name:"",deltas:[]};if(!t)return Object(r.a)({},e);var n=Object(r.a)({},e);t.name&&(n.name=t.name),t.deltas&&(n.deltas=t.deltas.map(I))}function I(t){return{}}function L(t){var e=t.autoSave,n=t.projectName,s=t.actions,i=Object(a.useState)(void 0),c=Object(O.a)(i,2),r=c[0],o=c[1];return Object(b.jsxs)("div",{children:[Object(b.jsx)("h1",{children:n}),Object(b.jsx)("button",{className:"vertical-center space-left-small",onClick:function(){s.setProjectName(prompt("Enter Project Name",n))},children:"Edit Project Name"}),Object(b.jsx)("input",{className:"vertical-center space-left-small",type:"file",onChange:function(t){console.log(t),o(t.target.files)}}),Object(b.jsx)("button",{className:"vertical-center space-left-small",disabled:!r,onClick:function(){if(r&&r[0]){var t=y();!function(t,e){if(t){var n=new FileReader;n.onloadend=function(){var t=n.result;e(t?N(JSON.parse(t)):N())},n.readAsText(t)}}(r[0],(function(e){s.loadStoredState((function(){return e}),t)}))}},children:"Import"}),Object(b.jsx)("button",{className:"vertical-center space-left-small",onClick:function(){return s.download()},children:"Export"}),Object(b.jsx)("button",{className:"vertical-center space-left-small",onClick:function(){return s.setAutoSave(!e)},children:e?"Auto Save: Enabled":"Auto Save: Disabled"}),Object(b.jsx)("button",{className:"vertical-center space-left-small",onClick:function(){return s.saveStateToLocalStorage()},children:"Save"})]})}function D(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return"calc(".concat(e.join(" "),")")}function E(t,e){return"max(".concat(t,", ").concat(e,")")}function P(t,e){var n,a="100vw",s="100vh",i="3rem",c="2rem",r="2rem",o="50rem",l=D(s,"-",i,"-",c),d=t?"3rem":E("16rem",(n="30%","min(".concat("24rem",", ").concat(n,")"))),h=D(a,"-",d),u=e?"1.8rem":E("12rem","20%"),b=D(l,"-",u);return{header:{x:0,y:0,w:a,h:i},side:{x:0,y:i,w:d,h:l,header:{x:0,y:0,w:"100%",h:r},main:{x:0,y:r,w:"100%",h:D(l,"-",r)}},footer:{x:0,y:D(s,"-",c),w:a,h:c},resources:{x:D(d,"+",o),y:D(s,"-",c,"-",u),w:o,h:u},actions:{x:d,y:D(s,"-",c,"-",u),w:o,h:u},map:{x:d,y:i,w:h,h:b}}}function F(t){var e=t.text;return Object(b.jsx)("span",{className:"vertical-center",children:e})}function R(t){var e=t.resourcesCollapsed,n=t.setResourcesCollapsed;return Object(b.jsxs)("div",{children:[Object(b.jsxs)("div",{children:[Object(b.jsx)(j,{expanded:!e,setExpanded:function(t){return n(!t)}}),Object(b.jsx)("strong",{children:" Split Detail"})]}),"[WIP]"]})}function H(t){var e=t.enabled,n=t.text,a=t.okText,s=t.cancelText,i=t.onOk,c=t.onCancel;if(!e)return null;var r="12rem";return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{style:{backgroundColor:"rgba(0,0,0,0.6)",position:"absolute",top:0,left:0,width:"100vw",height:"100vh"}}),Object(b.jsx)(p,{layout:{x:D(D("100vw","-","50%"),"/",2),y:D(D("100vh","-",r),"/",2),w:"50%",h:r},children:Object(b.jsxs)("div",{style:{backgroundColor:"white",height:"100%",boxSizing:"border-box",padding:"1rem"},children:[n,Object(b.jsxs)("div",{style:{position:"absolute",bottom:"1rem",right:"1rem"},children:[Object(b.jsx)("button",{onClick:function(){return i()},children:a}),void 0!==c&&Object(b.jsx)("button",{className:"margin-small",onClick:function(){return c()},children:s})]})]})})]})}var M=function(t){Object(d.a)(n,t);var e=Object(h.a)(n);function n(t){var a;return Object(o.a)(this,n),(a=e.call(this,t)).state={info:"Loading...",projectName:"Loading...",sideCollapsed:!1,resourcesCollapsed:!1,dimensions:void 0,branches:[],activeBranch:-1,activeSplit:-1,autoSave:!0,autoSaveHandle:void 0,displayAlert:!1,onAlertOk:void 0,onAlertCancel:void 0,alertOkText:void 0,alertCancelText:void 0,alertText:void 0},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.calculateDimensions.bind(this)),this.calculateDimensions(),this.loadStoredState(A),this.setAutoSave(!0)}},{key:"createDeepCopyOfBranchesFromState",value:function(){function t(t){return Object(r.a)({},t)}function e(e){return{name:e.name,deltas:e.deltas.map(t)}}function n(t){return{name:t.name,expanded:t.expanded,actions:t.actions.map(e)}}return this.state.branches.map((function(t){return{name:t.name,expanded:t.expanded,splits:t.splits.map(n)}}))}},{key:"setAutoSave",value:function(t){var e=this;if(t){if(this.state.autoSaveHandle){var n=this.state.autoSaveHandle;this.setState({autoSaveHandle:window.setInterval((function(){e.saveStateToLocalStorage()}),2e4),autoSave:!0},(function(){window.clearInterval(n)}))}else this.setState({autoSaveHandle:window.setInterval((function(){e.saveStateToLocalStorage()}),2e4),autoSave:!0});this.saveStateToLocalStorage()}else{if(this.state.autoSaveHandle){var a=this.state.autoSaveHandle;this.setState({autoSaveHandle:void 0,autoSave:!1},(function(){window.clearInterval(a)}))}else this.setState({autoSave:!1});this.setInformation("Auto save is now off.")}}},{key:"loadStoredState",value:function(t,e){var n=this,a=e||y(),s=t();s&&this.setState({branches:s.branches,activeBranch:s.activeBranch,activeSplit:s.activeSplit,projectName:s.projectName},(function(){n.setInformation("Data loaded in ".concat(C(a)," ms"))}))}},{key:"saveStateToLocalStorage",value:function(){var t=y();!function(t){var e=JSON.stringify(N(t));localStorage.setItem(w,e)}(this.getStateToStore()),this.setInformation("Saved to local storage in ".concat(C(t)," ms. Last saved at ").concat(new Date))}},{key:"getStateToStore",value:function(){return{branches:this.state.branches,activeBranch:this.state.activeBranch,activeSplit:this.state.activeSplit,projectName:this.state.projectName}}},{key:"calculateDimensions",value:function(){var t=P(this.state.sideCollapsed,this.state.resourcesCollapsed);this.setState({dimensions:t})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.calculateDimensions.bind(this)),this.state.autoSaveHandle&&window.clearInterval(this.state.autoSaveHandle)}},{key:"setSideCollapsed",value:function(t){this.setState({sideCollapsed:t,dimensions:P(t,this.state.resourcesCollapsed)})}},{key:"setResourcesCollapsed",value:function(t){this.setState({resourcesCollapsed:t,dimensions:P(this.state.sideCollapsed,t)})}},{key:"setInformation",value:function(t){this.setState({info:t})}},{key:"setProjectName",value:function(t){this.setState({projectName:t})}},{key:"setBranchPropertyAt",value:function(t,e,n){var a=this.createDeepCopyOfBranchesFromState();a[t][e]=n,this.setState({branches:a})}},{key:"swapBranchesAt",value:function(t,e){var n=this;if(t>=0&&t<this.state.branches.length&&e>=0&&e<this.state.branches.length&&t!==e){var a=y(),s=this.createDeepCopyOfBranchesFromState(),i=s[t];s[t]=s[e],s[e]=i;var c=this.state.activeBranch;this.state.activeBranch===t?c=e:this.state.activeBranch===e&&(c=t),this.setState({branches:s,activeBranch:c},(function(){n.setInformation("Branch moved in ".concat(C(a)," ms"))}))}}},{key:"createBranchAt",value:function(t){var e=this;if(this.state.branches.length>=128)return this.displayAlert("You have reached the maximum number of branches allowed (".concat(128,")"),"OK",(function(){e.hideAlert()})),void this.setInformation("Branch Limit Reached.");var n=y(),a=this.createDeepCopyOfBranchesFromState(),s={name:"Branch ".concat(a.length+1),expanded:!0,splits:[]},i=this.state.activeBranch;t>=a.length?a.push(s):(a.splice(t,0,s),i>=t&&i++),this.setState({branches:a,activeBranch:i},(function(){e.setInformation("Branch added in ".concat(C(n)," ms"))}))}},{key:"deleteBranchAt",value:function(t){var e=this,n=y(),a=this.createDeepCopyOfBranchesFromState(),s=this.state.activeBranch,i=this.state.activeSplit;a.splice(t,1),s===t?(s=-1,i=-1):s>t&&s--,this.setState({branches:a,activeBranch:s,activeSplit:i},(function(){e.setInformation("Branch deleted in ".concat(C(n)," ms"))}))}},{key:"createSplitAt",value:function(t,e){var n=this;if(this.state.branches[t].splits.length>=200)return this.displayAlert("You have reached the maximum number of splits allowed in one branch (".concat(200,")"),"OK",(function(){n.hideAlert()})),void this.setInformation("Split Limit Reached.");var a=y(),s=this.createDeepCopyOfBranchesFromState(),i={name:"Unnamed Split",expanded:!0,actions:[]},c=this.state.activeSplit;e>=s[t].splits.length?s[t].splits.push(i):(s[t].splits.splice(e,0,i),this.state.activeBranch==t&&c>=e&&c++),this.setState({branches:s,activeSplit:c},(function(){n.setInformation("Split added in ".concat(C(a)," ms"))}))}},{key:"setSplitPropertyAt",value:function(t,e,n,a){var s=this.createDeepCopyOfBranchesFromState();s[t].splits[e][n]=a,this.setState({branches:s})}},{key:"deleteSplitAt",value:function(t,e){var n=this,a=y(),s=this.createDeepCopyOfBranchesFromState(),i=this.state.activeBranch,c=this.state.activeSplit;s[t].splits.splice(e,1),i===t&&(c===e?(i=-1,c=-1):c>e&&c--),this.setState({branches:s,activeBranch:i,activeSplit:c},(function(){n.setInformation("Split deleted in ".concat(C(a)," ms"))}))}},{key:"displayAlert",value:function(t,e,n,a,s){this.setState({displayAlert:!0,onAlertOk:n,onAlertCancel:s,alertOkText:e,alertCancelText:a,alertText:t})}},{key:"hideAlert",value:function(){this.setState({displayAlert:!1,onAlertOk:void 0,onAlertCancel:void 0,alertOkText:void 0,alertCancelText:void 0})}},{key:"downloadStateToFile",value:function(){!function(t){var e=JSON.stringify(N(t)),n=new Blob([e],{type:"text"}),a=document.createElement("a"),s=t.projectName+".json"||!1;a.download=s,a.href=URL.createObjectURL(n),a.dataset.downloadurl=["text",a.download,a.href].join(":"),a.style.display="none",document.body.appendChild(a),a.click(),document.body.removeChild(a),setTimeout((function(){URL.revokeObjectURL(a.href)}),1500)}(this.getStateToStore())}},{key:"render",value:function(){var t=this;if(!this.state.dimensions)return null;var e={setSideCollapsed:this.setSideCollapsed.bind(this),setResourcesCollapsed:this.setResourcesCollapsed.bind(this),setInformation:this.setInformation.bind(this),setBranchExpandedAt:function(e,n){return t.setBranchPropertyAt(e,"expanded",n)},setBranchNameAt:function(e,n){return t.setBranchPropertyAt(e,"name",n)},createBranchAt:this.createBranchAt.bind(this),setAutoSave:this.setAutoSave.bind(this),deleteBranchAt:this.deleteBranchAt.bind(this),displayAlert:this.displayAlert.bind(this),hideAlert:this.hideAlert.bind(this),swapBranchesAt:this.swapBranchesAt.bind(this),saveStateToLocalStorage:this.saveStateToLocalStorage.bind(this),createSplitAt:this.createSplitAt.bind(this),setSplitExpandedAt:function(e,n,a){return t.setSplitPropertyAt(e,n,"expanded",a)},setSplitNameAt:function(e,n,a){return t.setSplitPropertyAt(e,n,"name",a)},deleteSplitAt:this.deleteSplitAt.bind(this),download:this.downloadStateToFile.bind(this),setProjectName:this.setProjectName.bind(this),loadStoredState:this.loadStoredState.bind(this)};return Object(b.jsxs)("div",{style:{width:"100vw",height:"100vh"},children:[Object(b.jsx)(p,{layout:this.state.dimensions.header,borderClass:"border",children:Object(b.jsx)(L,{autoSave:this.state.autoSave,projectName:this.state.projectName,actions:e})}),Object(b.jsx)(p,{layout:this.state.dimensions.side,borderClass:"border",children:Object(b.jsx)(S,{layout:this.state.dimensions.side,sideCollapsed:this.state.sideCollapsed,actions:e,branches:this.state.branches})}),Object(b.jsx)(p,{layout:this.state.dimensions.footer,borderClass:"border",children:Object(b.jsx)(F,{text:this.state.info})}),Object(b.jsx)(p,{layout:this.state.dimensions.map,borderClass:"border",children:Object(b.jsx)("iframe",{src:"https://objmap.zeldamods.org/#/map/z3,0,4",title:"Object Map",width:"100%",height:"100%"})}),Object(b.jsx)(p,{layout:this.state.dimensions.actions,borderClass:"border",children:Object(b.jsx)(R,{resourcesCollapsed:this.state.resourcesCollapsed,setResourcesCollapsed:function(e){return t.setResourcesCollapsed(e)}})}),Object(b.jsx)(p,{layout:this.state.dimensions.resources,borderClass:"border",children:"[WIP]"}),Object(b.jsx)(H,{enabled:this.state.displayAlert,text:this.state.alertText,okText:this.state.alertOkText,cancelText:this.state.alertCancelText,onOk:this.state.onAlertOk,onCancel:this.state.onAlertCancel})]})}}]),n}(s.a.Component);c.a.render(Object(b.jsx)(s.a.StrictMode,{children:Object(b.jsx)(M,{})}),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.89bcf797.chunk.js.map